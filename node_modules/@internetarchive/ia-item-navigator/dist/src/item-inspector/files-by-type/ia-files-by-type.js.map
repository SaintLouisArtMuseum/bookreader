{"version":3,"file":"ia-files-by-type.js","sourceRoot":"","sources":["../../../../src/item-inspector/files-by-type/ia-files-by-type.ts"],"names":[],"mappings":";AACA,OAAO,EAAE,IAAI,EAAE,aAAa,EAAE,UAAU,EAAE,QAAQ,EAAE,MAAM,aAAa,CAAC;AAQxE,IAAqB,aAAa,GAAlC,MAAqB,aAAc,SAAQ,UAAU;IAArD;;QAC8B,SAAI,GAAqB,EAAsB,CAAC;QAEjD,sBAAiB,GAAW,EAAE,CAAC;QAE/B,mBAAc,GAAuB,EAAE,CAAC;IAqFrE,CAAC;IAnFC,YAAY;QACV,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC;IAED,MAAM;QACJ,OAAO,IAAI,CAAA;;uBAEQ,IAAI,CAAC,cAAc,CAAC,MAAM;;uBAE1B,IAAI,CAAC,iBAAiB,CAAC,MAAM;;;;KAI/C,CAAC;IACJ,CAAC;IAED,YAAY;QACV,uBAAuB;QACvB,sBAAsB;QACtB,sBAAsB;QACtB,sBAAsB;QACtB,sBAAsB;QACtB,uBAAuB;QACvB,yBAAyB;QACzB,yCAAyC;QACzC,gBAAgB;QAChB,+BAA+B;QAC/B,MAAM;QAEN,OAAO,IAAI,CAAC;IACd,CAAC;IAED,aAAa;QACX,MAAM,EAAE,KAAK,GAAG,EAAE,EAAE,GAAG,IAAI,aAAJ,IAAI,uBAAJ,IAAI,CAAE,IAAwB,CAAC;QAEtD,MAAM,iBAAiB,GAAW,EAAE,CAAC;QACrC,MAAM,OAAO,GAAQ,EAAE,CAAC;QAExB,KAAK,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE;YACjB,MAAM,EAAE,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,QAAQ,GAAG,EAAE,EAAE,GAAG,EAAU,CAAC;YAC3D,IACE,MAAM,CAAC,WAAW,EAAE,KAAK,UAAU;gBACnC,MAAM,CAAC,WAAW,EAAE,KAAK,WAAW,EACpC;gBACA,iBAAiB,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;gBAC3B,OAAO;aACR;YAED,IAAI,SAAS,GAAQ,EAAE,CAAC;YACxB,IAAI,MAAM,KAAK,UAAU,EAAE;gBACzB,SAAS,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;gBAC1B,IAAI,CAAC,SAAS,EAAE;oBACd,UAAU;oBACV,OAAO,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE,WAAW,EAAE,EAAE,EAAsB,CAAC;oBAC/D,SAAS,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;iBAC3B;qBAAM;oBACL,SAAS;oBACT,MAAM,MAAM,GAAG,EAAE,GAAG,SAAS,EAAE,GAAG,EAAE,EAAE,CAAC;oBACvC,OAAO,CAAC,IAAI,CAAC,GAAG,MAAM,CAAC;iBACxB;gBACD,OAAO;aACR;YAED,IAAI,MAAM,KAAK,YAAY,EAAE;gBAC3B,MAAM,SAAS,GAAG,QAAQ,IAAI,EAAE,CAAC;gBACjC,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC;gBAC/B,IAAI,CAAC,SAAS,IAAI,QAAQ,EAAE;oBAC1B,UAAU;oBACV,MAAM,SAAS,GAAG,EAAE,WAAW,EAAE,EAAE,EAAsB,CAAC;oBAC1D,SAAS,GAAG,SAAS,CAAC;oBACtB,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;oBAChC,OAAO,CAAC,SAAS,CAAC,GAAG,SAAS,CAAC;oBAC/B,SAAS,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC;iBAChC;gBACD,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;aACjC;QACH,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,iBAAiB,GAAG,iBAAiB,CAAC;QAC3C,IAAI,CAAC,cAAc,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,CAC5C,CAAC,QAAgB,EAAE,EAAE,CAAC,OAAO,CAAC,QAAQ,CAAC,CACxC,CAAC;IACJ,CAAC;CACF,CAAA;AAzF6B;IAA3B,QAAQ,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;2CAAiD;AAEjD;IAA1B,QAAQ,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC;wDAAgC;AAE/B;IAA1B,QAAQ,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,CAAC;qDAAyC;AALhD,aAAa;IADjC,aAAa,CAAC,kBAAkB,CAAC;GACb,aAAa,CA0FjC;eA1FoB,aAAa","sourcesContent":["import { MetadataResponse, File } from '@internetarchive/search-service';\nimport { html, customElement, LitElement, property } from 'lit-element';\n\ninterface CollapsedFileInt extends File {\n  [menuId: string]: any;\n  derivatives: [];\n}\n\n@customElement('ia-files-by-type')\nexport default class IaFilesByType extends LitElement {\n  @property({ type: Object }) item: MetadataResponse = {} as MetadataResponse;\n\n  @property({ type: Array }) archivalArtifacts: File[] = [];\n\n  @property({ type: Array }) collapsedFiles: CollapsedFileInt[] = [];\n\n  firstUpdated() {\n    this.collapseFiles();\n  }\n\n  render() {\n    return html`\n      <div>\n        <p>there are ${this.collapsedFiles.length} original files</p>\n\n        <p>there are ${this.archivalArtifacts.length} archival artifacts</p>\n\n        <p></p>\n      </div>\n    `;\n  }\n\n  sortByViewer() {\n    //   const images = [];\n    //   const books = [];\n    //   const radio = [];\n    //   const audio = [];\n    //   const video = [];\n    //   const albums = [];\n    //   const software = [];\n    //  this.collapsedFiles.forEach((fi) => {\n    //   // if image\n    //   // sort by various viewers\n    //  })\n\n    return true;\n  }\n\n  collapseFiles() {\n    const { files = [] } = this?.item as MetadataResponse;\n\n    const archivalArtifacts: File[] = [];\n    const origDir: any = {};\n\n    files.forEach(fi => {\n      const { format, source, name, original = '' } = fi as File;\n      if (\n        format.toLowerCase() === 'metadata' ||\n        format.toLowerCase() === 'item tile'\n      ) {\n        archivalArtifacts.push(fi);\n        return;\n      }\n\n      let origEntry: any = {};\n      if (source === 'original') {\n        origEntry = origDir[name];\n        if (!origEntry) {\n          // add new\n          origDir[name] = { ...fi, derivatives: [] } as CollapsedFileInt;\n          origEntry = origDir[name];\n        } else {\n          // update\n          const merged = { ...origEntry, ...fi };\n          origDir[name] = merged;\n        }\n        return;\n      }\n\n      if (source === 'derivative') {\n        const keyToFile = original || '';\n        origEntry = origDir[keyToFile];\n        if (!origEntry && original) {\n          // add new\n          const fileFrame = { derivatives: [] } as CollapsedFileInt;\n          origEntry = fileFrame;\n          origEntry?.derivatives.push(fi);\n          origDir[keyToFile] = origEntry;\n          origEntry = origDir[keyToFile];\n        }\n        origEntry?.derivatives.push(fi);\n      }\n    });\n\n    this.archivalArtifacts = archivalArtifacts;\n    this.collapsedFiles = Object.keys(origDir).map(\n      (fileName: string) => origDir[fileName]\n    );\n  }\n}\n"]}