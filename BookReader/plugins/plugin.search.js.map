{"version":3,"file":"plugins/plugin.search.js","mappings":"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","sources":["webpack://@internetarchive/bookreader/./src/plugins/search/view.js","webpack://@internetarchive/bookreader/./src/plugins/search/utils.js","webpack://@internetarchive/bookreader/./src/plugins/search/plugin.search.js","webpack://@internetarchive/bookreader/./node_modules/core-js/modules/es.object.entries.js"],"sourcesContent":["class SearchView {\r\n  /**\r\n   * @param {object} params\r\n   * @param {object} params.br The BookReader instance\r\n   * @param {function} params.cancelSearch callback when a user wants to cancel search\r\n   *\r\n   * @event BookReader:SearchResultsCleared - when the search results nav gets cleared\r\n   * @event BookReader:ToggleSearchMenu - when search results menu should toggle\r\n   */\r\n  constructor({ br, searchCancelledCallback = () => {} }) {\r\n    this.br = br;\r\n    this.matches = [];\r\n    this.cacheDOMElements();\r\n    this.bindEvents();\r\n    this.cancelSearch = searchCancelledCallback;\r\n  }\r\n\r\n  cacheDOMElements() {\r\n    this.dom = {};\r\n    // Search input within the top toolbar. Will be removed once the mobile menu is replaced.\r\n    this.dom.toolbarSearch = this.buildToolbarSearch();\r\n  }\r\n\r\n  /**\r\n   * @param {string} query\r\n   */\r\n  setQuery(query) {\r\n    this.br.$('[name=\"query\"]').val(query);\r\n  }\r\n\r\n  emptyMatches() {\r\n    this.matches = [];\r\n  }\r\n\r\n  removeResultPins() {\r\n    this.br.$('.BRnavpos .BRsearch').remove();\r\n  }\r\n\r\n  clearSearchFieldAndResults(dispatchEventWhenComplete = true) {\r\n    this.br.removeSearchResults();\r\n    this.removeResultPins();\r\n    this.emptyMatches();\r\n    this.setQuery('');\r\n    this.teardownSearchNavigation();\r\n    if (dispatchEventWhenComplete) {\r\n      this.br.trigger('SearchResultsCleared');\r\n    }\r\n  }\r\n\r\n  toggleSidebar() {\r\n    this.br.trigger('ToggleSearchMenu');\r\n  }\r\n\r\n  renderSearchNavigation() {\r\n    const selector = 'BRsearch-navigation';\r\n    $('.BRnav').before(`\r\n      <div class=\"${selector}\">\r\n        <button class=\"toggle-sidebar\">\r\n          <h4>\r\n            <span class=\"icon icon-search\"></span> Results\r\n          </h4>\r\n        </button>\r\n        <div class=\"pagination\">\r\n          <button class=\"prev\" title=\"Previous result\"><span class=\"icon icon-chevron hflip\"></span></button>\r\n          <span data-id=\"resultsCount\">${this.resultsPosition()}</span>\r\n          <button class=\"next\" title=\"Next result\"><span class=\"icon icon-chevron\"></button>\r\n        </div>\r\n        <button class=\"clear\" title=\"Clear search results\">\r\n          <span class=\"icon icon-close\"></span>\r\n        </button>\r\n      </div>\r\n    `);\r\n    this.dom.searchNavigation = $(`.${selector}`);\r\n  }\r\n\r\n  resultsPosition() {\r\n    let positionMessage = `${this.matches.length} result${this.matches.length === 1 ? '' : 's'}`;\r\n    if (~this.currentMatchIndex) {\r\n      positionMessage = `${this.currentMatchIndex + 1} / ${this.matches.length}`;\r\n    }\r\n    return positionMessage;\r\n  }\r\n\r\n  bindSearchNavigationEvents() {\r\n    if (!this.dom.searchNavigation) { return; }\r\n    const namespace = 'searchNavigation';\r\n\r\n    this.dom.searchNavigation\r\n      .on(`click.${namespace}`, '.clear', this.clearSearchFieldAndResults.bind(this))\r\n      .on(`click.${namespace}`, '.prev', this.showPrevResult.bind(this))\r\n      .on(`click.${namespace}`, '.next', this.showNextResult.bind(this))\r\n      .on(`click.${namespace}`, '.toggle-sidebar', this.toggleSidebar.bind(this))\r\n      .on(`click.${namespace}`, false);\r\n  }\r\n\r\n  showPrevResult() {\r\n    if (this.currentMatchIndex === 0) { return; }\r\n    if (this.br.mode === this.br.constModeThumb) { this.br.switchMode(this.br.constMode1up); }\r\n    if (!~this.currentMatchIndex) {\r\n      this.currentMatchIndex = this.getClosestMatchIndex((start, end, comparator) => end[0] > comparator) + 1;\r\n    }\r\n    this.br.$('.BRnavline .BRsearch').eq(--this.currentMatchIndex).click();\r\n    this.updateResultsPosition();\r\n    this.updateSearchNavigationButtons();\r\n  }\r\n\r\n  showNextResult() {\r\n    if (this.currentMatchIndex + 1 === this.matches.length) { return; }\r\n    if (this.br.mode === this.br.constModeThumb) { this.br.switchMode(this.br.constMode1up); }\r\n    if (!~this.currentMatchIndex) {\r\n      this.currentMatchIndex = this.getClosestMatchIndex((start, end, comparator) => start[start.length - 1] > comparator) - 1;\r\n    }\r\n    this.br.$('.BRnavline .BRsearch').eq(++this.currentMatchIndex).click();\r\n    this.updateResultsPosition();\r\n    this.updateSearchNavigationButtons();\r\n  }\r\n\r\n  /**\r\n   * Obtains closest match based on the logical comparison function passed in.\r\n   * When the comparison function returns true, the starting (left) half of the\r\n   * matches array is used in the binary split, else the ending (right) half is\r\n   * used. A recursive call is made to perform the same split and comparison\r\n   * on the winning half of the matches. This is traditionally known as binary\r\n   * search (https://en.wikipedia.org/wiki/Binary_search_algorithm), and in\r\n   * most cases (medium to large search result arrays) should outperform\r\n   * traversing the array from start to finish. In the case of small arrays,\r\n   * the speed difference is negligible.\r\n   *\r\n   * @param {function} comparisonFn\r\n   * @return {number} matchIndex\r\n   */\r\n  getClosestMatchIndex(comparisonFn) {\r\n    const matchPages = this.matches.map((m) => m.par[0].page);\r\n    const currentPage = this.br.currentIndex() + 1;\r\n    const closestTo = (pool, comparator) => {\r\n      if (pool.length === 1) { return pool[0]; }\r\n      const start = pool.slice(0, pool.length / 2);\r\n      const end = pool.slice(pool.length / 2);\r\n      return closestTo((comparisonFn(start, end, comparator) ? start : end), comparator);\r\n    };\r\n\r\n    const closestPage = closestTo(matchPages, currentPage);\r\n    return this.matches.indexOf(this.matches.find((m) => m.par[0].page === closestPage));\r\n  }\r\n\r\n  updateResultsPosition() {\r\n    if (!this.dom.searchNavigation) return;\r\n    this.dom.searchNavigation.find('[data-id=resultsCount]').text(this.resultsPosition());\r\n  }\r\n\r\n  updateSearchNavigationButtons() {\r\n    if (!this.dom.searchNavigation) return;\r\n    this.dom.searchNavigation.find('.prev').attr('disabled', !this.currentMatchIndex);\r\n    this.dom.searchNavigation.find('.next').attr('disabled', this.currentMatchIndex + 1 === this.matches.length);\r\n  }\r\n\r\n  teardownSearchNavigation() {\r\n    if (!this.dom.searchNavigation) {\r\n      this.dom.searchNavigation = $('.BRsearch-navigation');\r\n    }\r\n    if (!this.dom.searchNavigation.length) { return; }\r\n\r\n    this.dom.searchNavigation.off('.searchNavigation').remove();\r\n    this.dom.searchNavigation = null;\r\n    this.br.resize();\r\n  }\r\n\r\n  setCurrentMatchIndex() {\r\n    let matchingSearchResult;\r\n    if (this.br.mode === this.br.constModeThumb) {\r\n      this.currentMatchIndex = -1;\r\n      return;\r\n    }\r\n    if (this.br.mode === this.br.constMode2up) {\r\n      matchingSearchResult = this.find2upMatchingSearchResult();\r\n    }\r\n    else {\r\n      matchingSearchResult = this.find1upMatchingSearchResult();\r\n    }\r\n    this.currentMatchIndex = this.matches.indexOf(matchingSearchResult);\r\n  }\r\n\r\n  find1upMatchingSearchResult() {\r\n    return this.matches.find((m) => this.br.currentIndex() === m.par[0].page - 1);\r\n  }\r\n\r\n  find2upMatchingSearchResult() {\r\n    return this.matches.find((m) => this.br._isIndexDisplayed(m.par[0].page - 1));\r\n  }\r\n\r\n  updateSearchNavigation() {\r\n    if (!this.matches.length) { return; }\r\n\r\n    this.setCurrentMatchIndex();\r\n    this.updateResultsPosition();\r\n    this.updateSearchNavigationButtons();\r\n  }\r\n\r\n  /**\r\n   * @param {boolean} bool\r\n   */\r\n  togglePinsFor(bool) {\r\n    const pinsVisibleState = bool ? 'visible' : 'hidden';\r\n    this.br.refs.$BRfooter.find('.BRsearch').css({ visibility: pinsVisibleState });\r\n  }\r\n\r\n  buildToolbarSearch() {\r\n    const toolbarSearch = document.createElement('span');\r\n    toolbarSearch.classList.add('BRtoolbarSection', 'BRtoolbarSectionSearch');\r\n    toolbarSearch.innerHTML = `\r\n      <form class=\"BRbooksearch desktop\">\r\n        <input type=\"search\" name=\"query\" class=\"BRsearchInput\" value=\"\" placeholder=\"Search inside\"/>\r\n        <button type=\"submit\" class=\"BRsearchSubmit\">\r\n          <img src=\"/wp-content/themes/slam/dependencies/manuscript/BookReader/images/icon_search_button.svg\" />\r\n        </button>\r\n      </form>\r\n    `;\r\n    return toolbarSearch;\r\n  }\r\n\r\n  /**\r\n   * @param {array} matches\r\n   */\r\n  renderPins(matches) {\r\n    matches.forEach((match) => {\r\n      const pageIndex = this.br.book.leafNumToIndex(match.par[0].page);\r\n      const uiStringSearch = \"Search result\"; // i18n\r\n      const percentThrough = this.br.constructor.util.cssPercentage(pageIndex, this.br.book.getNumLeafs() - 1);\r\n\r\n      let html = match.html;\r\n      if (html.length > 200) {\r\n        const start = Math.max(0, html.indexOf('<mark>') - 100);\r\n        if (start != 0) {\r\n          html = 'â€¦' + match.html\r\n            .substring(start)\r\n            // Make sure at word boundary though\r\n            .replace(/^\\S+/, '');\r\n        }\r\n      }\r\n      // draw marker\r\n      $('<div>')\r\n        .addClass('BRsearch')\r\n        .css({\r\n          left: percentThrough,\r\n        })\r\n        .attr('title', uiStringSearch)\r\n        .append(`\r\n          <div class=\"BRquery\">\r\n            <main>${html}</main>\r\n          </div>\r\n        `)\r\n        .appendTo(this.br.$('.BRnavline'))\r\n        .on(\"mouseenter\", (event) => {\r\n          // remove from other markers then turn on just for this\r\n          // XXX should be done when nav slider moves\r\n          const marker = event.currentTarget;\r\n          const tooltip = marker.querySelector('.BRquery');\r\n          const tooltipOffset = tooltip.getBoundingClientRect();\r\n          const targetOffset = marker.getBoundingClientRect();\r\n          const boxSizeAdjust = parseInt(getComputedStyle(tooltip).paddingLeft) * 2;\r\n          if (tooltipOffset.x - boxSizeAdjust < 0) {\r\n            tooltip.style.setProperty('transform', `translateX(-${targetOffset.left - boxSizeAdjust}px)`);\r\n          }\r\n          $('.BRsearch,.BRchapter').removeClass('front');\r\n          $(event.target).addClass('front');\r\n        })\r\n        .on(\"mouseleave\", (event) => $(event.target).removeClass('front'))\r\n        .on(\"click\", () => { this.br._searchPluginGoToResult(match.matchIndex); });\r\n    });\r\n  }\r\n  /*<footer>Page ${match.displayPageNumber}</footer> removed after line 249 */\r\n\r\n  /**\r\n   * @param {boolean} bool\r\n   */\r\n  toggleSearchPending(bool) {\r\n    if (bool) {\r\n      this.br.showProgressPopup(\"Search results will appear below...\", () => this.progressPopupClosed());\r\n    }\r\n    else {\r\n      this.br.removeProgressPopup();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Primary callback when user cancels search popup\r\n   */\r\n  progressPopupClosed() {\r\n    this.toggleSearchPending();\r\n    this.cancelSearch();\r\n  }\r\n\r\n  renderErrorModal(textIsProcessing = false) {\r\n    const errorDetails = `${!textIsProcessing ? 'The text may still be processing. ' : ''}Please try again.`;\r\n    this.renderModalMessage(`\r\n      Sorry, there was an error with your search.\r\n      <br />\r\n      ${errorDetails}\r\n    `);\r\n    this.delayModalRemovalFor(4000);\r\n  }\r\n\r\n  renderBookNotIndexedModal() {\r\n    this.renderModalMessage(`\r\n      <p>\r\n         This book hasn't been indexed for searching yet.\r\n         We've just started indexing it, so search should be available soon.\r\n         <br />\r\n         Please try again later. Thanks!\r\n      </p>\r\n    `);\r\n    this.delayModalRemovalFor(5000);\r\n  }\r\n\r\n  renderResultsEmptyModal() {\r\n    this.renderModalMessage('No matches were found.');\r\n    this.delayModalRemovalFor(2000);\r\n  }\r\n\r\n  /**\r\n   * @param {string} messageHTML The innerHTML string used to popupate the modal contents\r\n   */\r\n  renderModalMessage(messageHTML) {\r\n    const modal = document.createElement('div');\r\n    modal.classList.add('BRprogresspopup', 'search_modal');\r\n    modal.innerHTML = messageHTML;\r\n    document.querySelector(this.br.el).append(modal);\r\n  }\r\n\r\n  /**\r\n   * @param {number} timeoutMS\r\n   */\r\n  delayModalRemovalFor(timeoutMS) {\r\n    setTimeout(this.br.removeProgressPopup.bind(this.br), timeoutMS);\r\n  }\r\n\r\n  /**\r\n   * @param {Event} e\r\n   */\r\n  submitHandler(e) {\r\n    e.preventDefault();\r\n    const query = e.target.querySelector('[name=\"query\"]').value;\r\n    if (!query.length) { return false; }\r\n    this.br.search(query);\r\n    this.emptyMatches();\r\n    this.toggleSearchPending(true);\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * @param {Event} e\r\n   * @param {object} properties\r\n   *   @param {object} properties.results\r\n   *   @param {object} properties.options\r\n   */\r\n  handleSearchCallback(e, { results, options }) {\r\n    this.matches = results.matches;\r\n    this.setCurrentMatchIndex();\r\n    this.teardownSearchNavigation();\r\n    this.renderSearchNavigation();\r\n    this.bindSearchNavigationEvents();\r\n    this.renderPins(results.matches);\r\n    this.toggleSearchPending(false);\r\n    if (options.goToFirstResult) {\r\n      $(document).one('BookReader:pageChanged', () => {\r\n        this.br.resize();\r\n      });\r\n    } else {\r\n      this.br.resize();\r\n    }\r\n  }\r\n\r\n  handleSearchStarted() {\r\n    this.emptyMatches();\r\n    this.br.removeSearchHilites();\r\n    this.removeResultPins();\r\n    this.toggleSearchPending(true);\r\n    this.teardownSearchNavigation();\r\n    this.setQuery(this.br.searchTerm);\r\n  }\r\n\r\n  /**\r\n   * Event listener for: `BookReader:SearchCallbackError`\r\n   * @param {CustomEvent} event\r\n   */\r\n  handleSearchCallbackError(event = {}) {\r\n    this.toggleSearchPending(false);\r\n    const isIndexed = event?.detail?.props?.results?.indexed;\r\n    this.renderErrorModal(isIndexed);\r\n  }\r\n\r\n  handleSearchCallbackBookNotIndexed() {\r\n    this.toggleSearchPending(false);\r\n    this.renderBookNotIndexedModal();\r\n  }\r\n\r\n  handleSearchCallbackEmpty() {\r\n    this.toggleSearchPending(false);\r\n    this.renderResultsEmptyModal();\r\n  }\r\n\r\n  bindEvents() {\r\n    const namespace = 'BookReader:';\r\n\r\n    window.addEventListener(`${namespace}SearchCallbackError`, this.handleSearchCallbackError.bind(this));\r\n    $(document).on(`${namespace}SearchCallback`, this.handleSearchCallback.bind(this))\r\n      .on(`${namespace}SearchStarted`, this.handleSearchStarted.bind(this))\r\n      .on(`${namespace}SearchCallbackBookNotIndexed`, this.handleSearchCallbackBookNotIndexed.bind(this))\r\n      .on(`${namespace}SearchCallbackEmpty`, this.handleSearchCallbackEmpty.bind(this))\r\n      .on(`${namespace}pageChanged`, this.updateSearchNavigation.bind(this));\r\n\r\n    this.dom.toolbarSearch.querySelector('form').addEventListener('submit', this.submitHandler.bind(this));\r\n  }\r\n}\r\n\r\nexport default SearchView;\r\n","import { escapeHTML, escapeRegExp } from '../../BookReader/utils.js';\r\n\r\n/**\r\n * @param {string} match\r\n * @param {string} preTag\r\n * @param {string} postTag\r\n * @returns {string}\r\n */\r\nexport function renderMatch(match, preTag, postTag) {\r\n  // Search results are returned as a text blob with the hits wrapped in\r\n  // triple mustaches. Hits occasionally include text beyond the search\r\n  // term, so everything within the staches is captured and wrapped.\r\n  const preTagRe = escapeRegExp(escapeHTML(preTag));\r\n  const postTagRe = escapeRegExp(escapeHTML(postTag));\r\n  // [^] matches any character, including line breaks\r\n  const regex = new RegExp(`${preTagRe}([^]+?)${postTagRe}`, 'g');\r\n  return escapeHTML(match)\r\n    .replace(regex, '<mark>$1</mark>')\r\n    // Fix trailing hyphens. This over-corrects but is net useful.\r\n    .replace(/(\\b)- /g, '$1');\r\n}\r\n\r\n/**\r\n * Attach some fields to search inside results\r\n * @param {SearchInsideResults} results\r\n * @param {(pageNum: LeafNum) => PageNumString} displayPageNumberFn\r\n * @param {string} preTag\r\n * @param {string} postTag\r\n */\r\nexport function marshallSearchResults(results, displayPageNumberFn, preTag, postTag) {\r\n  // Attach matchIndex to a few things to make it easier to identify\r\n  // an active/selected match\r\n  for (const [index, match] of results.matches.entries()) {\r\n    match.matchIndex = index;\r\n    match.displayPageNumber = displayPageNumberFn(match.par[0].page);\r\n    match.html = renderMatch(match.text, preTag, postTag);\r\n    for (const par of match.par) {\r\n      for (const box of par.boxes) {\r\n        box.matchIndex = index;\r\n      }\r\n    }\r\n  }\r\n}\r\n","// @ts-check\r\n/* global BookReader */\r\n/**\r\n * Plugin for Archive.org book search\r\n * Events fired at various points throughout search processing are published\r\n * on the document DOM element. These can be subscribed to using jQuery's event\r\n * binding method `$.fn.on`. All of the events are prefixed with a BookReader\r\n * namespace. The events are:\r\n *\r\n * @event BookReader:SearchStarted - When a search form is submitted, immediately\r\n *   before an AJAX call is made to request search results\r\n * @event BookReader:SearchCallback - When the search AJAX call is returned and at\r\n *   least one result is returned. The event callback receives an object\r\n *   with the `results`, plugin `options`, and the BookReader `instance`\r\n * @event BookReader:SearchCallbackError - When the AJAX request returns an error.\r\n *   Receives the `results` and `instance`\r\n * @event BookReader:SearchCallbackNotIndexed - When a message is received that\r\n *   the book has not had OCR text indexed yet. Receives `instance`\r\n * @event BookReader:SearchCallbackEmpty - When no results found. Receives\r\n *   `instance`\r\n * @event BookReader:SearchCanceled - When no results found. Receives\r\n *   `instance`\r\n */\r\nimport { poll } from '../../BookReader/utils.js';\r\nimport { renderBoxesInPageContainerLayer } from '../../BookReader/PageContainer.js';\r\nimport SearchView from './view.js';\r\nimport { marshallSearchResults } from './utils.js';\r\n/** @typedef {import('../../BookReader/PageContainer').PageContainer} PageContainer */\r\n/** @typedef {import('../../BookReader/BookModel').PageIndex} PageIndex */\r\n/** @typedef {import('../../BookReader/BookModel').LeafNum} LeafNum */\r\n/** @typedef {import('../../BookReader/BookModel').PageNumString} PageNumString */\r\n\r\njQuery.extend(BookReader.defaultOptions, {\r\n  server: 'ia600609.us.archive.org',\r\n  bookId: '',\r\n  subPrefix: '',\r\n  bookPath: '',\r\n  enableSearch: true,\r\n  searchInsideProtocol: 'https',\r\n  searchInsideUrl: '/fulltext/inside.php',\r\n  searchInsidePreTag: '{{{',\r\n  searchInsidePostTag: '}}}',\r\n  initialSearchTerm: null,\r\n});\r\n\r\n/** @override */\r\nBookReader.prototype.setup = (function (super_) {\r\n  return function (options) {\r\n    super_.call(this, options);\r\n\r\n    this.searchTerm = '';\r\n    this.searchResults = null;\r\n    this.searchInsideUrl = options.searchInsideUrl;\r\n    this.enableSearch = options.enableSearch;\r\n\r\n    // Base server used by some api calls\r\n    this.bookId = options.bookId;\r\n    this.server = options.server;\r\n    this.subPrefix = options.subPrefix;\r\n    this.bookPath = options.bookPath;\r\n\r\n    this.searchXHR = null;\r\n    this._cancelSearch.bind(this);\r\n    this.cancelSearchRequest.bind(this);\r\n\r\n    /** @type { {[pageIndex: number]: SearchInsideMatchBox[]} } */\r\n    this._searchBoxesByIndex = {};\r\n\r\n    this.searchView = undefined;\r\n  };\r\n})(BookReader.prototype.setup);\r\n\r\n/** @override */\r\nBookReader.prototype.init = (function (super_) {\r\n  return function () {\r\n    super_.call(this);\r\n    // give SearchView the most complete bookreader state\r\n    this.searchView = new SearchView({\r\n      br: this,\r\n      searchCancelledCallback: () => {\r\n        this._cancelSearch();\r\n        this.trigger('SearchCanceled', { term: this.searchTerm, instance: this });\r\n      }\r\n    });\r\n    if (this.options.enableSearch && this.options.initialSearchTerm) {\r\n      /**\r\n       * this.search() take two parameter\r\n       * 1. this.options.initialSearchTerm - search term\r\n       * 2. {\r\n       *  goToFirstResult: this.options.goToFirstResult,\r\n       *  suppressFragmentChange: false // always want to change fragment in URL\r\n       * }\r\n       */\r\n      this.search(\r\n        this.options.initialSearchTerm,\r\n        { goToFirstResult: this.options.goToFirstResult, suppressFragmentChange: false }\r\n      );\r\n    }\r\n  };\r\n})(BookReader.prototype.init);\r\n\r\n/** @override */\r\nBookReader.prototype.buildToolbarElement = (function (super_) {\r\n  return function () {\r\n    const $el = super_.call(this);\r\n    if (!this.enableSearch) { return; }\r\n    if (this.searchView.dom.toolbarSearch) {\r\n      $el.find('.BRtoolbarSectionInfo').after(this.searchView.dom.toolbarSearch);\r\n    }\r\n    return $el;\r\n  };\r\n})(BookReader.prototype.buildToolbarElement);\r\n\r\n/** @override */\r\nBookReader.prototype._createPageContainer = (function (super_) {\r\n  return function (index) {\r\n    const pageContainer = super_.call(this, index);\r\n    if (this.enableSearch && pageContainer.page && index in this._searchBoxesByIndex) {\r\n      const pageIndex = pageContainer.page.index;\r\n      const boxes = this._searchBoxesByIndex[pageIndex];\r\n      renderBoxesInPageContainerLayer(\r\n        'searchHiliteLayer',\r\n        boxes,\r\n        pageContainer.page,\r\n        pageContainer.$container[0],\r\n        boxes.map(b => `match-index-${b.matchIndex}`),\r\n      );\r\n    }\r\n    return pageContainer;\r\n  };\r\n})(BookReader.prototype._createPageContainer);\r\n\r\n/**\r\n * @typedef {object} SearchOptions\r\n * @property {boolean} goToFirstResult\r\n * @property {boolean} disablePopup\r\n * @property {(null|function)} error - @deprecated at v.5.0\r\n * @property {(null|function)} success - @deprecated at v.5.0\r\n */\r\n\r\n/**\r\n * Submits search request\r\n *\r\n * @param {string} term\r\n * @param {SearchOptions} overrides\r\n */\r\nBookReader.prototype.search = async function(term = '', overrides = {}) {\r\n  /** @type {SearchOptions} */\r\n  const defaultOptions = {\r\n    goToFirstResult: false, /* jump to the first result (default=false) */\r\n    disablePopup: false,    /* don't show the modal progress (default=false) */\r\n    suppressFragmentChange: false, /* don't change the URL on initial load */\r\n    error: null,            /* optional error handler (default=null) */\r\n    success: null,          /* optional success handler (default=null) */\r\n\r\n  };\r\n  const options = jQuery.extend({}, defaultOptions, overrides);\r\n  this.suppressFragmentChange = options.suppressFragmentChange;\r\n  this.searchCancelled = false;\r\n\r\n  // strip slashes, since this goes in the url\r\n  this.searchTerm = term.replace(/\\//g, ' ');\r\n\r\n  if (!options.suppressFragmentChange) {\r\n    this.trigger(BookReader.eventNames.fragmentChange);\r\n  }\r\n\r\n  // Add quotes to the term. This is to compenstate for the backends default OR query\r\n  // term = term.replace(/['\"]+/g, '');\r\n  // term = '\"' + term + '\"';\r\n\r\n  // Remove the port and userdir\r\n  const serverPath = this.server.replace(/:.+/, '');\r\n  const baseUrl = `${this.options.searchInsideProtocol}://${serverPath}${this.searchInsideUrl}?`;\r\n\r\n  // Remove subPrefix from end of path\r\n  let path = this.bookPath;\r\n  const subPrefixWithSlash = `/${this.subPrefix}`;\r\n  if (this.bookPath.length - this.bookPath.lastIndexOf(subPrefixWithSlash) == subPrefixWithSlash.length) {\r\n    path = this.bookPath.substr(0, this.bookPath.length - subPrefixWithSlash.length);\r\n  }\r\n\r\n  const urlParams = {\r\n    item_id: this.bookId,\r\n    doc: this.subPrefix,\r\n    path,\r\n    q: term,\r\n    pre_tag: this.options.searchInsidePreTag,\r\n    post_tag: this.options.searchInsidePostTag,\r\n  };\r\n\r\n  // NOTE that the API does not expect / (slashes) to be encoded. (%2F) won't work\r\n  const paramStr = $.param(urlParams).replace(/%2F/g, '/');\r\n\r\n  const url = `${baseUrl}${paramStr}`;\r\n\r\n  const callSearchResultsCallback = (searchInsideResults) => {\r\n    if (this.searchCancelled) {\r\n      return;\r\n    }\r\n    const responseHasError = searchInsideResults.error || !searchInsideResults.matches.length;\r\n    const hasCustomError = typeof options.error === 'function';\r\n    const hasCustomSuccess = typeof options.success === 'function';\r\n\r\n    if (responseHasError) {\r\n      console.error('Search Inside Response Error', searchInsideResults.error || 'matches.length == 0');\r\n      hasCustomError\r\n        ? options.error.call(this, searchInsideResults, options)\r\n        : this.BRSearchCallbackError(searchInsideResults, options);\r\n    } else {\r\n      hasCustomSuccess\r\n        ? options.success.call(this, searchInsideResults, options)\r\n        : this.BRSearchCallback(searchInsideResults, options);\r\n    }\r\n  };\r\n\r\n  this.trigger('SearchStarted', { term: this.searchTerm, instance: this });\r\n  callSearchResultsCallback(await $.ajax({\r\n    url: url,\r\n    dataType: 'jsonp',\r\n    cache: true,\r\n    beforeSend: xhr => { this.searchXHR = xhr; },\r\n  }));\r\n};\r\n\r\n/**\r\n * cancels AJAX Call\r\n * emits custom event\r\n */\r\nBookReader.prototype._cancelSearch = function () {\r\n  this.searchXHR?.abort();\r\n  this.searchView.clearSearchFieldAndResults(false);\r\n  this.searchTerm = '';\r\n  this.searchXHR = null;\r\n  this.searchCancelled = true;\r\n  this.searchResults = [];\r\n};\r\n\r\n/**\r\n * External function to cancel search\r\n * checks for term & xhr in flight before running\r\n */\r\nBookReader.prototype.cancelSearchRequest = function () {\r\n  this.searchCancelled = true;\r\n  if (this.searchXHR !== null) {\r\n    this._cancelSearch();\r\n    this.searchView.toggleSearchPending();\r\n    this.trigger('SearchCanceled', { term: this.searchTerm, instance: this });\r\n  }\r\n};\r\n\r\n/**\r\n  * @typedef {object} SearchInsideMatchBox\r\n  * @property {number} page\r\n  * @property {number} r\r\n  * @property {number} l\r\n  * @property {number} b\r\n  * @property {number} t\r\n  * @property {HTMLDivElement} [div]\r\n  * @property {number} matchIndex This is a fake field! not part of the API response. The index of the match that contains this box in total search results matches.\r\n  */\r\n\r\n/**\r\n * @typedef {object} SearchInsideMatch\r\n * @property {number} matchIndex This is a fake field! Not part of the API response. It is added by the JS.\r\n * @property {string} displayPageNumber (fake field) The page number as it should be displayed in the UI.\r\n * @property {string} html (computed field) The html-escaped raw html to display in the UI.\r\n * @property {string} text\r\n * @property {Array<{ page: number, boxes: SearchInsideMatchBox[] }>} par\r\n */\r\n\r\n/**\r\n * @typedef {object} SearchInsideResults\r\n * @property {string} error\r\n * @property {SearchInsideMatch[]} matches\r\n * @property {boolean} indexed\r\n */\r\n\r\n/**\r\n * Search Results return handler\r\n * @param {SearchInsideResults} results\r\n * @param {object} options\r\n * @param {boolean} options.goToFirstResult\r\n */\r\nBookReader.prototype.BRSearchCallback = function(results, options) {\r\n  marshallSearchResults(\r\n    results,\r\n    pageNum => this.book.getPageNum(this.book.leafNumToIndex(pageNum)),\r\n    this.options.searchInsidePreTag,\r\n    this.options.searchInsidePostTag,\r\n  );\r\n  this.searchResults = results || [];\r\n\r\n  this.updateSearchHilites();\r\n  this.removeProgressPopup();\r\n  if (options.goToFirstResult) {\r\n    this._searchPluginGoToResult(0);\r\n  }\r\n  this.trigger('SearchCallback', { results, options, instance: this });\r\n};\r\n\r\n/**\r\n * Main search results error handler\r\n * @callback\r\n * @param {SearchInsideResults} results\r\n */\r\nBookReader.prototype.BRSearchCallbackError = function(results) {\r\n  this._BRSearchCallbackError(results);\r\n};\r\n\r\n/**\r\n * @private draws search results error\r\n * @callback\r\n * @param {SearchInsideResults} results\r\n * @param {jQuery} $el\r\n * @param {boolean} fade\r\n */\r\nBookReader.prototype._BRSearchCallbackError = function(results) {\r\n  this.searchResults = results;\r\n  const basePayload = {\r\n    term: this.searchTerm,\r\n    instance: this,\r\n  };\r\n  if (results.error) {\r\n    const payload = Object.assign({}, basePayload, { results });\r\n    this.trigger('SearchCallbackError', payload);\r\n  } else if (0 == results.matches.length) {\r\n    if (false === results.indexed) {\r\n      this.trigger('SearchCallbackBookNotIndexed', basePayload);\r\n      return;\r\n    }\r\n    this.trigger('SearchCallbackEmpty', basePayload);\r\n  }\r\n};\r\n\r\n/**\r\n * updates search on-page highlights controller\r\n */\r\nBookReader.prototype.updateSearchHilites = function() {\r\n  /** @type {SearchInsideMatch[]} */\r\n  const matches = this.searchResults?.matches || [];\r\n  /** @type { {[pageIndex: number]: SearchInsideMatchBox[]} } */\r\n  const boxesByIndex = {};\r\n\r\n  // Clear any existing svg layers\r\n  this.removeSearchHilites();\r\n\r\n  // Group by pageIndex\r\n  for (const match of matches) {\r\n    for (const box of match.par[0].boxes) {\r\n      const pageIndex = this.book.leafNumToIndex(box.page);\r\n      const pageBoxes = boxesByIndex[pageIndex] || (boxesByIndex[pageIndex] = []);\r\n      pageBoxes.push(box);\r\n    }\r\n  }\r\n\r\n  // update any already created pages\r\n  for (const [pageIndexString, boxes] of Object.entries(boxesByIndex)) {\r\n    const pageIndex = parseFloat(pageIndexString);\r\n    const page = this.book.getPage(pageIndex);\r\n    const pageContainers = this.getActivePageContainerElementsForIndex(pageIndex);\r\n    for (const container of pageContainers) {\r\n      renderBoxesInPageContainerLayer('searchHiliteLayer', boxes, page, container, boxes.map(b => `match-index-${b.matchIndex}`));\r\n    }\r\n  }\r\n\r\n  this._searchBoxesByIndex = boxesByIndex;\r\n};\r\n\r\n/**\r\n * remove search highlights\r\n */\r\nBookReader.prototype.removeSearchHilites = function() {\r\n  $(this.getActivePageContainerElements()).find('.searchHiliteLayer').remove();\r\n};\r\n\r\n/**\r\n * @private\r\n * Goes to the page specified. If the page is not viewable, tries to load the page\r\n * FIXME Most of this logic is IA specific, and should be less integrated into here\r\n * or at least more configurable.\r\n * @param {number} matchIndex\r\n */\r\nBookReader.prototype._searchPluginGoToResult = async function (matchIndex) {\r\n  const match = this.searchResults?.matches[matchIndex];\r\n  const book = this.book;\r\n  const pageIndex = book.leafNumToIndex(match.par[0].page);\r\n  const page = book.getPage(pageIndex);\r\n  const onNearbyPage = Math.abs(this.currentIndex() - pageIndex) < 3;\r\n  let makeUnviewableAtEnd = false;\r\n  if (!page.isViewable) {\r\n    const resp = await fetch('/services/bookreader/request_page?' + new URLSearchParams({\r\n      id: this.options.bookId,\r\n      subprefix: this.options.subPrefix,\r\n      leafNum: page.leafNum,\r\n    })).then(r => r.json());\r\n\r\n    for (const leafNum of resp.value) {\r\n      book.getPage(book.leafNumToIndex(leafNum)).makeViewable();\r\n    }\r\n\r\n    // not able to show page; make the page viewable anyways so that it can\r\n    // actually open. On IA, it has a fallback to a special error page.\r\n    if (!resp.value.length) {\r\n      book.getPage(pageIndex).makeViewable();\r\n      makeUnviewableAtEnd = true;\r\n    }\r\n\r\n    // Trigger an update of book\r\n    this._modes.mode1Up.mode1UpLit.updatePages();\r\n    if (this.activeMode == this._modes.mode1Up) {\r\n      await this._modes.mode1Up.mode1UpLit.updateComplete;\r\n    }\r\n  }\r\n  /* this updates the URL */\r\n  if (!this._isIndexDisplayed(pageIndex)) {\r\n    this.suppressFragmentChange = false;\r\n    this.jumpToIndex(pageIndex);\r\n  }\r\n\r\n  // Reset it to unviewable if it wasn't resolved\r\n  if (makeUnviewableAtEnd) {\r\n    book.getPage(pageIndex).makeViewable(false);\r\n  }\r\n\r\n  // Scroll/flash in the ui\r\n  const $boxes = await poll(() => $(`rect.match-index-${match.matchIndex}`), { until: result => result.length > 0 });\r\n  if ($boxes.length) {\r\n    $boxes.css('animation', 'none');\r\n    $boxes[0].scrollIntoView({\r\n      // Only vertically center the highlight if we're in 1up or in full screen. In\r\n      // 2up, if we're not fullscreen, the whole body gets scrolled around to try to\r\n      // center the highlight ðŸ™„ See:\r\n      // https://stackoverflow.com/questions/11039885/scrollintoview-causing-the-whole-page-to-move/11041376\r\n      // Note: nearest doesn't quite work great, because the ReadAloud toolbar is now\r\n      // full-width, and covers up the last line of the highlight.\r\n      block: this.constMode1up == this.mode || this.isFullscreenActive ? 'center' : 'nearest',\r\n      inline: 'center',\r\n      behavior: onNearbyPage ? 'smooth' : 'auto',\r\n    });\r\n    // wait for animation to start\r\n    await new Promise(resolve => setTimeout(resolve, 100));\r\n    $boxes.removeAttr(\"style\");\r\n  }\r\n};\r\n\r\n/**\r\n * Removes all search pins\r\n */\r\nBookReader.prototype.removeSearchResults = function(suppressFragmentChange = false) {\r\n  this.removeSearchHilites(); //be sure to set all box.divs to null\r\n  this.searchTerm = null;\r\n  this.searchResults = null;\r\n  if (!suppressFragmentChange) {\r\n    this.trigger(BookReader.eventNames.fragmentChange);\r\n  }\r\n};\r\n\r\n/**\r\n * Returns true if a search highlight is currently being displayed\r\n * @returns {boolean}\r\n */\r\nBookReader.prototype.searchHighlightVisible = function() {\r\n  const results = this.searchResults;\r\n  let visiblePages = [];\r\n  if (null == results) return false;\r\n\r\n  if (this.constMode2up == this.mode) {\r\n    visiblePages = [this.twoPage.currentIndexL, this.twoPage.currentIndexR];\r\n  } else if (this.constMode1up == this.mode) {\r\n    visiblePages = [this.currentIndex()];\r\n  } else {\r\n    return false;\r\n  }\r\n\r\n  results.matches.some(match => {\r\n    return match.par[0].boxes.some(box => {\r\n      const pageIndex = this.book.leafNumToIndex(box.page);\r\n      if (jQuery.inArray(pageIndex, visiblePages) >= 0) {\r\n        return true;\r\n      }\r\n    });\r\n  });\r\n\r\n  return false;\r\n};\r\n","'use strict';\nvar $ = require('../internals/export');\nvar $entries = require('../internals/object-to-array').entries;\n\n// `Object.entries` method\n// https://tc39.es/ecma262/#sec-object.entries\n$({ target: 'Object', stat: true }, {\n  entries: function entries(O) {\n    return $entries(O);\n  }\n});\n"],"names":["SearchView","_ref","br","_ref$searchCancelledC","searchCancelledCallback","_classCallCheck","this","matches","cacheDOMElements","bindEvents","cancelSearch","key","value","dom","toolbarSearch","buildToolbarSearch","query","$","val","remove","dispatchEventWhenComplete","arguments","length","undefined","removeSearchResults","removeResultPins","emptyMatches","setQuery","teardownSearchNavigation","trigger","selector","before","concat","resultsPosition","searchNavigation","positionMessage","currentMatchIndex","namespace","on","clearSearchFieldAndResults","bind","showPrevResult","showNextResult","toggleSidebar","mode","constModeThumb","switchMode","constMode1up","getClosestMatchIndex","start","end","comparator","eq","click","updateResultsPosition","updateSearchNavigationButtons","comparisonFn","closestPage","closestTo","pool","slice","map","m","par","page","currentIndex","indexOf","find","text","attr","off","resize","matchingSearchResult","constMode2up","find2upMatchingSearchResult","find1upMatchingSearchResult","_this","_this2","_isIndexDisplayed","setCurrentMatchIndex","bool","pinsVisibleState","refs","$BRfooter","css","visibility","document","createElement","classList","add","innerHTML","_this3","forEach","match","pageIndex","book","leafNumToIndex","percentThrough","constructor","util","cssPercentage","getNumLeafs","html","Math","max","substring","replace","addClass","left","append","appendTo","event","marker","currentTarget","tooltip","querySelector","tooltipOffset","getBoundingClientRect","targetOffset","boxSizeAdjust","parseInt","getComputedStyle","paddingLeft","x","style","setProperty","removeClass","target","_searchPluginGoToResult","matchIndex","_this4","showProgressPopup","progressPopupClosed","removeProgressPopup","toggleSearchPending","errorDetails","renderModalMessage","delayModalRemovalFor","messageHTML","modal","el","timeoutMS","setTimeout","e","preventDefault","search","_ref2","_this5","results","options","renderSearchNavigation","bindSearchNavigationEvents","renderPins","goToFirstResult","one","removeSearchHilites","searchTerm","_event$detail","isIndexed","detail","props","indexed","renderErrorModal","renderBookNotIndexedModal","renderResultsEmptyModal","window","addEventListener","handleSearchCallbackError","handleSearchCallback","handleSearchStarted","handleSearchCallbackBookNotIndexed","handleSearchCallbackEmpty","updateSearchNavigation","submitHandler","renderMatch","preTag","postTag","preTagRe","escapeRegExp","escapeHTML","postTagRe","regex","RegExp","super_","_regeneratorRuntime","t","r","Object","prototype","n","hasOwnProperty","o","defineProperty","i","Symbol","a","iterator","c","asyncIterator","u","toStringTag","define","enumerable","configurable","writable","wrap","Generator","create","Context","makeInvokeMethod","tryCatch","type","arg","call","h","l","f","s","y","GeneratorFunction","GeneratorFunctionPrototype","p","d","getPrototypeOf","v","values","g","defineIteratorMethods","_invoke","AsyncIterator","invoke","_typeof","resolve","__await","then","callInvokeWithMethodAndArg","Error","done","method","delegate","maybeInvokeDelegate","sent","_sent","dispatchException","abrupt","return","TypeError","resultName","next","nextLoc","pushTryEntry","tryLoc","catchLoc","finallyLoc","afterLoc","tryEntries","push","resetTryEntry","completion","reset","isNaN","displayName","isGeneratorFunction","name","mark","setPrototypeOf","__proto__","awrap","async","Promise","keys","reverse","pop","prev","charAt","stop","rval","handle","complete","finish","catch","delegateYield","asyncGeneratorStep","_asyncToGenerator","apply","_next","_throw","jQuery","extend","BookReader","defaultOptions","server","bookId","subPrefix","bookPath","enableSearch","searchInsideProtocol","searchInsideUrl","searchInsidePreTag","searchInsidePostTag","initialSearchTerm","setup","searchResults","searchXHR","_cancelSearch","cancelSearchRequest","_searchBoxesByIndex","searchView","init","term","instance","suppressFragmentChange","buildToolbarElement","$el","after","_createPageContainer","index","pageContainer","boxes","renderBoxesInPageContainerLayer","$container","b","_callee","overrides","serverPath","baseUrl","path","subPrefixWithSlash","urlParams","paramStr","url","callSearchResultsCallback","_args","_context","disablePopup","error","success","searchCancelled","eventNames","fragmentChange","lastIndexOf","substr","item_id","doc","q","pre_tag","post_tag","param","searchInsideResults","responseHasError","hasCustomError","hasCustomSuccess","console","BRSearchCallbackError","BRSearchCallback","t0","ajax","dataType","cache","beforeSend","xhr","t1","_this$searchXHR","abort","displayPageNumberFn","_step","pageNum","_iterator","_createForOfIteratorHelper","entries","_step$value","displayPageNumber","getPageNum","_step2","_iterator2","_step3","_iterator3","err","marshallSearchResults","updateSearchHilites","_BRSearchCallbackError","basePayload","payload","assign","_this$searchResults","boxesByIndex","box","_i","_Object$entries","_Object$entries$_i","pageIndexString","parseFloat","getPage","getActivePageContainerElementsForIndex","container","getActivePageContainerElements","_callee2","_this$searchResults2","onNearbyPage","makeUnviewableAtEnd","resp","_iterator4","_step4","leafNum","$boxes","_context2","abs","isViewable","fetch","URLSearchParams","id","subprefix","json","makeViewable","_modes","mode1Up","mode1UpLit","updatePages","activeMode","updateComplete","jumpToIndex","poll","until","result","scrollIntoView","block","isFullscreenActive","inline","behavior","removeAttr","_x","searchHighlightVisible","visiblePages","twoPage","currentIndexL","currentIndexR","some","inArray","$entries","stat","O"],"sourceRoot":""}